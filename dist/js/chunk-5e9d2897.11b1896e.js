(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e9d2897"],{"061b":function(t,e,s){t.exports=s("7017")},"30a6":function(t,e,s){"use strict";var n=s("4db7"),r=s.n(n);r.a},"4ae4":function(t,e,s){},"4db7":function(t,e,s){},7017:function(t,e,s){s("85cd"),t.exports=s("a7d3").Object.getPrototypeOf},7179:function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-container",{attrs:{"grid-list-xl":""}},[s("v-layout",{attrs:{row:"",wrap:""}},[s("v-flex",{staticClass:"headline font-weight-light",attrs:{xs12:"","pt-5":"","pb-0":""}},[t._v("\n      Processor allows you to run scripts on streams.\n      "),s("v-btn",{attrs:{color:"primary"},on:{click:t.runProcessor}},[t._v("\n        Run\n      ")])],1),s("v-flex",{attrs:{xs12:""}},[s("v-text-field",{model:{value:t.initInput,callback:function(e){t.initInput=e},expression:"initInput"}})],1),t._l(t.chosenBlocks,function(e,n){return s("v-flex",{key:n,attrs:{xs12:""}},[s("processor-block",{attrs:{index:n,block:e,output:t.blockOutput[n],successRun:t.blockSuccess[n]},on:{"remove-block":t.removeBlock,"update-param":t.updateParam}})],1)}),s("v-flex",{attrs:{xs12:""}},[s("v-combobox",{attrs:{items:t.allBlocks,"item-text":function(t){return t.name},label:"Add new block"},on:{change:t.addBlock}})],1)],2)],1)},r=[],o=(s("ac6a"),s("28a5"),s("7514"),s("75fc")),c=(s("20d6"),s("a481"),s("061b"),s("96cf"),s("3b8d")),a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-card",[s("v-card-title",[s("span",{staticClass:"title font-weight-light"},[t._v("\n      "+t._s(t.index+1)+" : "+t._s(t.block.name)+"\n    ")]),s("v-spacer"),s("span",[s("v-dialog",{attrs:{width:"700"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[s("v-btn",t._g({attrs:{icon:""}},n),[s("v-icon",[t._v("code")])],1)]}}])},[s("v-card",[s("v-card-title",[s("span",{staticClass:"title font-weight-light"},[t._v("\n              "+t._s(t.block.name)+"\n            ")])]),s("v-card-text",{staticStyle:{"word-wrap":"break-word"}},[s("pre",[t._v("              "+t._s(t.block.script)+"\n            ")])])],1)],1),s("v-btn",{attrs:{icon:""},on:{click:function(e){return t.$emit("remove-block",t.index)}}},[s("v-icon",[t._v("close")])],1)],1)],1),Object.keys(t.params).length>0?s("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},t._l(t.block.params,function(e){return s("v-text-field",{key:e,attrs:{label:e},on:{change:function(e){return t.$emit("update-param",{index:t.index,params:t.params})}},model:{value:t.params[e],callback:function(s){t.$set(t.params,e,s)},expression:"params[param]"}})}),1):t._e(),null!=JSON.stringify(t.output)?s("v-alert",{attrs:{value:!0,type:t.alertState}},[JSON.stringify(t.output).length<100?s("span",[t._v(" "+t._s(JSON.stringify(t.output))+" ")]):s("span",[t._v(" "+t._s(JSON.stringify(t.output).substring(0,100)+"...")+" ")])]):t._e()],1)},i=[],u=s("a4bb"),l=s.n(u),p={name:"ProcessorBlock",props:{index:null,block:Object,output:null,successRun:null},computed:{alertState:function(){return this.successRun?"success":"error"}},data:function(){return{}},methods:{},created:function(){this.params=l()(this.block.params)}},h=p,d=(s("30a6"),s("2877")),m=Object(d["a"])(h,a,i,!1,null,"11a2d97d",null);m.options.__file="ProcessorBlock.vue";var f=m.exports,b=s("bc3a"),k=s.n(b),v={name:"ProcessorView",components:{ProcessorBlock:f},computed:{allBlocks:function(){return this.$store.state.blocks}},data:function(){return{initInput:"",chosenBlocks:[],blockSuccess:[],blockOutput:[],blockParams:[],toRequest:[],requestBuckets:[],isRequesting:!1,pauseRequesting:!1,bucketInProgress:!1}},mutations:{},methods:{runProcessor:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){var e,s,n,r,o,c,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,k()({method:"POST",url:".netlify/functions/receiver",data:{baseUrl:k.a.defaults.baseURL,token:k.a.defaults.headers.common["Authorization"],streamId:"SsQ_U00IU-"}});case 2:return e=t.sent,console.log(e),t.abrupt("return");case 10:if(!(r<this.chosenBlocks.length)){t.next=23;break}return o=this.blockParams[r]?this.blockParams[r]:new Object,c=new n("self","input","params",this.chosenBlocks[r].script),t.next=15,c(this,s,o);case 15:a=t.sent,this.blockSuccess.push(!0),this.blockOutput.push(a),console.log(a),s=a;case 20:r++,t.next=10;break;case 23:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),addBlock:function(t){this.blockOutput.splice(0,this.blockOutput.length),this.blockSuccess.splice(0,this.blockSuccess.length),null!=t&&this.chosenBlocks.push(t)},removeBlock:function(t){this.blockOutput.splice(0,this.blockOutput.length),this.blockSuccess.splice(0,this.blockSuccess.length),this.chosenBlocks.splice(t,1)},updateParam:function(t){this.blockParams[t.index]=t.params},appendStreamsToRoute:function(t){var e=this.$store.state.loadedStreamIds.join(",");""!==e?this.$router.replace({name:"processor",params:{streamIds:e}}):this.$router.replace({name:"processor"})},addStream:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(e){var s,n,r,c,a,i,u=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.showLoading=!0,this.$store.commit("ADD_LOADED_STREAMID",e),this.appendStreamsToRoute(),t.next=5,this.$store.dispatch("getStreamObjects",e);case 5:for(s=t.sent,n=s.filter(function(t){return-1===u.$store.state.objects.findIndex(function(e){return e._id===t})}),r=s.filter(function(t){return-1!==u.$store.state.objects.findIndex(function(e){return e._id===t})}),this.$store.commit("UPDATE_OBJECTS_STREAMS",{objIds:r,streamToAdd:e}),c=[],a=50,i=0;i<n.length;i++)c.push(n[i]),i%a===0&&0!==i&&(this.requestBuckets.push({objectIds:Object(o["a"])(c),streamId:e}),c=[],this.isRequesting||this.bucketProcessor());0!==c.length&&(this.requestBuckets.push({objectIds:Object(o["a"])(c),streamId:e}),this.isRequesting||this.bucketProcessor());case 12:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),bucketProcessor:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){var e,s,n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.pauseRequesting){t.next=2;break}return t.abrupt("return");case 2:if(0!==this.requestBuckets.length){t.next=10;break}return this.isRequesting=!1,this.objectAccumulator.length>0&&this.$store.commit("ADD_OBJECTS",this.objectAccumulator),this.objectAccumulator=[],console.log("done processing buckets!"),this.showLoading=!1,bus.$emit("loading-done"),t.abrupt("return");case 10:return this.isRequesting=!0,this.bucketInProgress=!0,t.next=14,this.$store.dispatch("getObjects",this.requestBuckets[0].objectIds);case 14:s=t.sent,this.$store.state.streams.find(function(t){return t.streamId===n.requestBuckets[0].streamId}),(e=this.objectAccumulator).push.apply(e,Object(o["a"])(s.map(function(t){return t}))),this.requestBuckets.splice(0,1),this.bucketInProgress=!1,this.bucketProcessor();case 20:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),fetchStreamsFromRoute:function(){var t=this;if(this.$route.params.streamIds){var e=this.$route.params.streamIds.split(","),s=e.filter(function(e){return-1===t.$store.state.loadedStreamIds.indexOf(e)}),n=this.$store.state.loadedStreamIds.filter(function(t){return-1===e.indexOf(t)});console.log("i need to load ".concat(s.join(", "))),console.log("i need to unload ".concat(n.join(", "))),n.forEach(function(e){return t.removeStream(e)}),s.forEach(function(e){return t.addStream(e)})}}},mounted:function(){console.log("mounted"),this.objectAccumulator=[],this.fetchStreamsFromRoute()}},g=v,x=(s("b074"),Object(d["a"])(g,n,r,!1,null,"a2f8ea04",null));x.options.__file="Processor.vue";e["default"]=x.exports},"85cd":function(t,e,s){var n=s("0185"),r=s("ff0c");s("c165")("getPrototypeOf",function(){return function(t){return r(n(t))}})},b074:function(t,e,s){"use strict";var n=s("4ae4"),r=s.n(n);r.a}}]);
//# sourceMappingURL=chunk-5e9d2897.11b1896e.js.map